--Fastest pitchers in the Playoffs

SELECT 
   ROUND(AVG(pitchspeed),1) AS avg_speed,pitcherLastName, pitcherfirstname
FROM 
    `bigquery-public-data.baseball.games_post_wide` 
WHERE 
    pitcherLastName <> ''
GROUP BY 
    pitcherLastName, pitcherfirstname
ORDER BY 
    avg_speed DESC
    

--Fastest pitchers for Red Sox in the playoffs
SELECT 
   ROUND(AVG(pitchspeed),1) AS avg_speed,pitcherLastName, pitcherfirstname
FROM 
    `bigquery-public-data.baseball.games_post_wide` 
WHERE 
    venuestate = 'MA' AND pitcherLastName <> ''
GROUP BY 
    pitcherLastName, pitcherfirstname
ORDER BY 
    avg_speed DESC
    

--Average pitch speed for lefty pitchers

SELECT 
   ROUND(AVG(pitchspeed),1) AS avg_speed,pitcherLastName, pitcherfirstname, pitcherThrowHand
FROM 
    `bigquery-public-data.baseball.games_post_wide` 
WHERE 
    pitcherLastName <> '' AND pitcherThrowHand = 'L'
GROUP BY 
    pitcherLastName, pitcherfirstname,pitcherThrowHand
ORDER BY 
    avg_speed DESC


--Average pitch speed for righty pitchers

SELECT 
   ROUND(AVG(pitchspeed),1) AS avg_speed,pitcherLastName, pitcherfirstname, pitcherThrowHand
FROM 
    `bigquery-public-data.baseball.games_post_wide` 
WHERE 
    pitcherLastName <> '' AND pitcherThrowHand = 'R'
GROUP BY 
    pitcherLastName, pitcherfirstname,pitcherThrowHand
ORDER BY 
    avg_speed DESC



-- Number of lefty and righty pitchers

SELECT pitcherthrowhand,
    
    COUNT(DISTINCT pitcherid) AS NumberofPitchers
FROM 
    bigquery-public-data.baseball.games_post_wide
GROUP BY 
    pitcherthrowhand
HAVING 
    pitcherthrowhand != ''



--Using # of pitchers to get average type of pitch thrown per game by lefty and righty pitchers
-- Right handed pitchers variation

SELECT 
    COUNT(pitchtypedescription)/65 AS righty_thrown_pergame,pitcherthrowhand, pitchtypedescription
FROM 
    bigquery-public-data.baseball.games_post_wide
group by 
    pitchTypeDescription, pitcherthrowhand
HAVING 
    pitcherthrowhand != '' AND pitchtypedescription != '' AND pitcherthrowhand = 'R'
ORDER BY 
    pitchTypeDescription


--Left handed pitchers variation
SELECT 
    COUNT(pitchtypedescription)/32 AS righty_thrown_pergame,pitcherthrowhand, pitchtypedescription
FROM 
    bigquery-public-data.baseball.games_post_wide
group by 
    pitchTypeDescription, pitcherthrowhand
HAVING 
    pitcherthrowhand != '' AND pitchtypedescription != '' AND pitcherthrowhand = 'L'
ORDER BY 
    pitchTypeDescription
    

SELECT. lefty variation table]

--Almost there, gotta get a litte better to get this right

SELECT 
    COUNT(pitchtypedescription)/65 AS righty_thrown_pergame,
    COUNT(pitchtypedescription)/32 AS Lefty_thrown_pergame, pitcherthrowhand, pitchtypedescription
FROM 
    bigquery-public-data.baseball.games_post_wide
group by 
    pitchTypeDescription, pitcherthrowhand
HAVING 
    pitcherthrowhand != '' AND pitchtypedescription != ''
ORDER BY 
    pitchTypeDescription


--most strikeouts by pitchers in the playoffs
SELECT 
    COUNT(strikes) AS strike_outs, pitcherLastName,pitcherfirstname FROM bigquery-public-data.baseball.games_post_wide
WHERE 
    strikes = 3
GROUP BY 
    pitcherLastName, pitcherfirstname
ORDER BY 
    count(strikes) DESC

--Which types of pitches earned the most strikes
SELECT 
    sum(strikes) AS total_strikes, pitchTypeDescription, 
FROM 
    bigquery-public-data.baseball.games_post_wide
GROUP BY 
    pitchTypeDescription
HAVING 
    pitchTypeDescription != ''
ORDER BY 
    sum(strikes) DESC

--Most attended games through the playoffs
SELECT 
     DISTINCT homeTeamName, awayTeamName, attendance, venuecapacity,gameid 
FROM 
    bigquery-public-data.baseball.games_post_wide
ORDER BY 
    attendance DESC
